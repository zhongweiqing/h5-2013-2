<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>详情页</title>
    <link rel="stylesheet" href="../css/reset.css">
    <link rel="stylesheet" href="../font/iconfont.css">
    <link rel="stylesheet" href="../css/Detail.css">
</head>

<body>
    <!-- 头部 -->
    <div id="meizu_header" class="container">
        <div class="meizu_header_logo">
            <a href="../index.html"><img src="../images/[XYIXWYV5`4ZHO`3TO9@(29.png" alt=""></a>
        </div>
        <ul class="meizu_header_ul">
            <li>
                <a href="#">手机</a></li>
            <li>
                <a href="#">Liprol</a></li>
            <li>
                <a href="#">声学</a></li>
            <li>
                <a href="#">配件</a></li>
            <li>
                <a href="#">生活</a></li>
            <li>
                <a href="#">Flyme</a></li>
            <li>
                <a href="#">服务</a></li>
            <li>
                <a href="#">专卖店</a></li>
            <li>
                <a href="#">社区</a></li>
            <li>
                <a href="#">企业服务</a></li>
            <li>
                <a href="#">APP下载</a></li>
        </ul>
        <div class="header_search">
            <input type="text" name="" id="" class="inp" placeholder="魅族17">
            <a href="">
                <svg width="17px" height="14px" viewBox="0 0 17 14" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
                <g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
                    <g transform="translate(-1469.000000, -32.000000)" fill="#666666" fill-rule="nonzero">
                        <g>
                            <g>
                                <g transform="translate(1323.000000, 25.000000)">
                                    <g transform="translate(139.000000, 0.000000)">
                                        <path d="M14,20.75 C10.2720779,20.75 7.25,17.7279221 7.25,14 C7.25,10.2720779 10.2720779,7.25 14,7.25 C17.7279221,7.25 20.75,10.2720779 20.75,14 C20.75,17.7279221 17.7279221,20.75 14,20.75 Z M14,19.25 C16.8994949,19.25 19.25,16.8994949 19.25,14 C19.25,11.1005051 16.8994949,8.75 14,8.75 C11.1005051,8.75 8.75,11.1005051 8.75,14 C8.75,16.8994949 11.1005051,19.25 14,19.25 Z" id="Oval"></path>
                                        <path d="M19.0640714,18.1103001 C18.7270119,17.8695434 18.6489432,17.4011308 18.8896999,17.0640714 C19.1304566,16.7270119 19.5988692,16.6489432 19.9359286,16.8896999 L23.4359286,19.3896999 C23.7729881,19.6304566 23.8510568,20.0988692 23.6103001,20.4359286 C23.3695434,20.7729881 22.9011308,20.8510568 22.5640714,20.6103001 L19.0640714,18.1103001 Z" id="Line-2"></path>
                                    </g>
                                </g>
                            </g>
                        </g>
                    </g>
                </g>
                </svg>
            </a>
        </div>
        <div>
            <a href="./html/Login.html"><span class="iconfont font1">&#xe62a;</span></a>
            <a href="#"><span class="iconfont font2">&#xe6b8;</span></a>
        </div>

    </div>
    <!-- 中间详情 -->
    <div class="mian">
        <div class="common mian-inner">
            <div id="img-left">
                <div id="small" code="1">
                    <!-- 小图片所在的盒子 -->
                    <img class="picter" src="../images/06.png" alt="" style="width: 400px; height: 400px;" />
                    <div id="mask"></div>
                    <!-- 遮罩层:175*175 -->
                </div>
                <div id="big">
                    <!-- 大图片所在的盒子:450*450 -->
                    <img id="bigImg" src="../images/06.png" alt="" id="bigImg" />
                </div>
            </div>
            <div class="mian-right">
                <h2>魅族 17</h2>
                <p class="sale-desc">天玑 800U处理器 / 4800万像素主摄 / 6.53英寸超高清小孔全面屏 / 小金刚品质 / 5000mAh+18W快充 / 双5G待机 / 侧边指纹识别 / 线性马达 / 红外遥控</p>
                <p class="company-info"></p>
                <div class="price-info">
                    <span>1299元</span>
                </div>
                <!--  -->
                <div data-v-101 class="line"></div>
                <!--  -->
                <div class="buy-option">
                    <div class="buy-box-child">
                        <div data-v-105 class="title">选择版本</div>
                        <ul class="clearfix">
                            <li data-v-110="110" class="active">
                                <a data-v-110 href="javascript:void(0)">6GB+128GB</a>
                            </li>
                            <li data-v-110="111">
                                <a href="javascript:void(0)">8GB+128GB</a>
                            </li>
                            <li data-v-110="112">
                                <a href="javascript:void(0)">8GB+256GB</a>
                            </li>
                        </ul>
                    </div>
                    <div class="buy-box-child">
                        <div data-v-105 class="title">选择颜色</div>
                        <ul class="clearfix">
                            <li data-v-110="113" class="active">
                                <a data-v-110 href="javascript:void(0)">流影紫</a>
                            </li>
                            <li data-v-110="114">
                                <a href="javascript:void(0)">云墨灰</a>
                            </li>
                            <li data-v-110="115">
                                <a href="javascript:void(0)">青山外</a>
                            </li>
                        </ul>
                    </div>

                </div>
                <!--  -->
                <div class="selected-list">
                    <ul>
                        <li data-v-120>

                            <span data-v-title="130"></span>
                            <i data-y>元</i><span data-v-121>1299</span>
                        </li>
                    </ul>
                    <div class="total-price">总计:1299元</div>
                </div>
                <!--  -->
                <div class="btn-box">
                    <div class="sale-btn">
                        <a href="#" class="btn-primar">加入购物车</a>
                    </div>
                    <div class="sale-btn">
                        <a href="#" class="btn-orders">立即下单</a>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- 弹出框 -->
    <div class="popover">
        <h2>魅族 17</h2>
        <p class="sale-desc">天玑 800U处理器 / 4800万像素主摄 / 6.53英寸超高清小孔全面屏 / 小金刚品质 / 5000mAh+18W快充 / 双5G待机 / 侧边指纹识别 / 线性马达 / 红外遥控</p>
        <a href="#" class="del-x">X</a>
        <a href="./cart.html" class="settlement">立即结算</a>

    </div>
    <!-- 放大镜 -->
    <script src="../js/public.js"></script>
    <script>
        //获取相关元素
        var smallBox = $id('small'); //小盒子
        var bigBox = $id('big'); //大盒子
        var mask = $id('mask'); //遮罩层
        var box = $id('img-left'); //总容器
        var bigImg = $id('bigImg'); //大图片
        //1.鼠标移入small,big显示,mask显示
        smallBox.onmouseenter = function() {
                bigBox.style.display = "block";
                mask.style.display = "block";
            }
            //2 mask跟着鼠标移动，鼠标在mask中心位置
        smallBox.onmousemove = function(e) {
                e = e || window.event;
                //求出鼠标距离small的距离
                var left = e.clientX + getScroll().left - box.offsetLeft;
                var top = e.clientY + getScroll().top - box.offsetTop;
                //鼠标再mask中心，减去mask宽高的一半
                left = left - mask.offsetWidth / 2;
                top = top - mask.offsetHeight / 2;
                //边界监测
                if (left < 0) {
                    left = 0
                }
                if (left > smallBox.offsetWidth - mask.offsetWidth) {
                    left = smallBox.offsetWidth - mask.offsetWidth;
                }
                if (top < 0) {
                    top = 0;
                }
                if (top > smallBox.offsetHeight - mask.offsetHeight) {
                    top = smallBox.offsetHeight - mask.offsetHeight;
                }
                //定位mask
                mask.style.left = left + "px";
                mask.style.top = top + "px";
                // 3 mask对应的大图位置显示
                // left/350 = 大图左移的距离/800
                // top/350 = 大图上移的距离/800
                var x = left / smallBox.offsetWidth * bigImg.offsetWidth;
                var y = top / smallBox.offsetHeight * bigImg.offsetHeight;

                bigImg.style.marginLeft = -x + "px";
                bigImg.style.marginTop = -y + "px";
            }
            //4 鼠标移出small,big隐藏,mask隐藏
        smallBox.onmouseleave = function() {
            bigBox.style.display = "none";
            mask.style.display = "none";
        }
    </script>
    <!--  -->
    <script src="../js/jquery1.12.4.min.js"></script>
    <script src="../js/ajax.js"></script>
    <script src="../js/Detail.js"></script>

    <script>
        /* 
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    点击data-v-11x 加class active     
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 */
        // $('li[data-v-110 = "110"]').click(function() {
        //     $(this).addClass('active')
        //     $('li[data-v-120]').html(` <span data-v-title="130">Redmi Note 9 5G 6GB+128GB 流影紫</span><i data-y>元</i><span data-v-121>1299</span>`)
        //     $('.total-price').html('总计:1299元')
        //     $('li[data-v-110 = "111"]').removeClass('active')
        //     $('li[data-v-110 = "112"]').removeClass('active')

        // })
        // $('li[data-v-110 = "111"]').click(function() {
        //     $(this).addClass('active')
        //     $('li[data-v-120]').html(` <span data-v-title="130">Redmi Note 9 5G 8GB+128GB 流影紫</span>
        //     <i data-y>元</i><span data-v-121>1499</span>`)
        //     $('.total-price').html('总计:1499元')
        //     $('li[data-v-110 = "110"]').removeClass('active')
        //     $('li[data-v-110 = "112"]').removeClass('active')
        // })
        // $('li[data-v-110 = "112"]').click(function() {
        //         $(this).addClass('active')
        //         $('li[data-v-120]').html(` <span data-v-title="130">Redmi Note 9 5G 8GB+256GB 流影紫</span>
        //     <i data-y>元</i><span data-v-121>1699</span>`)
        //         $('.total-price').html('总计:1699元')
        //         $('li[data-v-110 = "111"]').removeClass('active')
        //         $('li[data-v-110 = "110"]').removeClass('active')
        //     })
        //     /* 
        //         点击data-v-110 ="113" active 
        //     */
        // $('li[data-v-110="113"]').click(function() {
        //     $(this).addClass('active');
        //     $('span[data-v-title="1"]').text("流影紫")
        //     $('li[data-v-110="114"]').removeClass('active')
        //     $('li[data-v-110="115"]').removeClass('active')
        // })
        // $('li[data-v-110="114"]').click(function() {
        //     $(this).addClass('active');
        //     $('span[data-v-title="2"]').text("云墨灰")
        //     $('li[data-v-110="113"]').removeClass('active')
        //     $('li[data-v-110="115"]').removeClass('active')
        // })
        // $('li[data-v-110="115"]').click(function() {
        //         $(this).addClass('active');
        //         $('span[data-v-title="3"]').text("青山外")
        //         $('li[data-v-110="114"]').removeClass('active')
        //         $('li[data-v-110="113"]').removeClass('active')
        //     })
        //点击del-x
        $('.del-x').on('click', function() {
                $('.popover').css('display', 'none')
            })
            //   点击加入购物车
        $('.btn-primar').on('click', function() {
            var num = 1;
            var price = $('span[data-v-121]').text();
            var text = $('span[data-v-title="130"]').text()
            var img = $('.picter').attr('src')
            var code = $('#small').attr('code')
            var total = num * price;

            //数据存储
            var metadata = {
                num: num,
                price: price,
                text: text,
                img: img,
                code: code,
                total: total
            };
            $('.popover').css('display', 'block')
            var zhang = [];

            if (localStorage.getItem('zhang')) {
                zhang = JSON.parse(localStorage.getItem('zhang'));
                var falg = true;
                zhang.forEach(function(item, index) {
                    if (metadata.code == item.code) {
                        metadata.num = metadata.num + item.num;
                        metadata.total = metadata.total + item.total;
                        zhang.splice(index, 1, metadata);
                        zhang = JSON.stringify(zhang);
                        localStorage.setItem('zhang', zhang);
                        falg = false;
                        return;
                    }
                });
                if (falg) {
                    //zhang里面没有这个商品
                    zhang.push(metadata);
                    zhang = JSON.stringify(zhang);
                    localStorage.setItem('zhang', zhang);
                }

            } else {
                zhang.push(metadata);
                zhang = JSON.stringify(zhang);
                localStorage.setItem('zhang', zhang);
            }
            return false;


        })

        //结算
        $(".settlement").on('click', function() {

            alert("结算成功");
            location.href = "../index.html";

        })
    </script>
</body>

</html>